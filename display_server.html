<!DOCTYPE html>
<html lang="en">
<head>
  <title>Wall of fame</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <link href="https://fonts.googleapis.com/css?family=Caveat+Brush" rel="stylesheet" >
  <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
  <link href="style.css" rel="stylesheet">

<script type="text/javascript">

$(document).ready(function() {

  function update_list(content)
  {
    var html = "";

    for (index = 0; index < content.length; ++index)
    {
      var element = content[index];
      html = html + "<tr><td>" + element['sentence'] + "</td>" + "<td>" + element['person'] + "</td>" + "<td>" + element['date'] + "</td>" + '<td><span class="glyphicon glyphicon-remove"></span></td><tr>';
    }
    $("#list").html(html);
  }

  $.get("list", function(data, status)
                {
                  if (status == "success")
                  {
                    update_list(jQuery.parseJSON(data));
                  }
                });

  $('#button').click(function(e)
  {
    e.preventDefault();

    $('#popup').fadeIn(0);
    $.post("add", 
            { 
              sentence : $("#sentence").val(), 
              person   : $("#person").val(), 
              date     : $("#date").val()
            },
            function(data, status)
            {
              $("#sentence").val("");
              $("#person").val("");
              $("#date").val("");

              if (status == "success")
              {
                var response = jQuery.parseJSON(data);
                console.log(response);
                if (response['status'] == 'ok')
                {
                  $("#popup").html('<div class="alert alert-success"><strong>Succes</strong> Citation envoyee avec succes </div>');
                  update_list(response['list']);
                }
                else
                {
                  $("#popup").html('<div class="alert alert-danger"><strong>Erreur</strong> ' + response['message'] + ' </div>');
                }
              }
              else
              {
                $("#popup").html('<div class="alert alert-danger"><strong>Erreur</strong> Erreur du serveur (' + status + ')</div>');
              }
            });
    $('#popup').delay(2000).fadeOut(500);
  });
});

</script>
</head>

<style>

.bg-1 {
  background-color: #1abc9c; 
  color: #ffffff;
  padding: 50px 60px;
}

.bg-grey {
  background-color: #f6f6f6;
}

.bg-dark {
  background-color: #797979;
}

.bg-white {
  background-color: #ffffff;
}

.container-fluid {
  padding: 50px 50px;
}

h1 {
  font-family: 'Caveat Brush', cursive;
  font-size:100px;
}

h2 {
  font-family: 'Roboto', sans-serif;
}

</style>

<body>
<div class="container-fluid text-center bg-1">
<h1>Les citations trop pimpantes</h1>
</div>

<div class="container-fluid bg-dark">
  <h2 style="color:#f6f6f6;"> <span style="font-size:24px;" class="glyphicon glyphicon-plus-sign"></span> Ajouter une citation</h2>
  <div style="width:80%;" class = "container-fluid bg-white">
  <form>
    <div class="form-group">
  <label for="sentence">Citation</label>
      <input type="text" class="form-control input-lg" id="sentence" placeholder="Entrer la citation de ouf entendue">
    </div>
    <div class="form-group">
      <label for="person">Personne</label>
      <input type="text" class="form-control" id="person" placeholder="Entrer son heureux proprietaire">
    </div>
    <div class="form-group">
      <label for="date">Date</label>
      <input type="text" class="form-control" id="date" placeholder="jj/mm/aaaa">
    </div>
    <button type="submit" id = "button" class="btn btn-default">Ajouter Ã  la liste !</button>
  </form>

  <br>

  <div id="popup">
  </div>
  
</div>
</div>

<div class="container-fluid">
<h2 style="color:#797979;"> <span style="font-size:24px;" class="glyphicon glyphicon-time"></span> Historique des citations</h2>
<div class="container-fluid" style="width:80%;" >


  <table class="table table-striped">
    <thead>
      <tr>
        <th>Citation</th>
        <th>Auteur</th>
        <th>Date</th>
        <th>Supprimer</th>
      </tr>
    </thead>
    <tbody id="list">
    </tbody>
  </table>

  <br>

</div>
<div>
</body>
</html>